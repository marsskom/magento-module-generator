<?xml version="1.0" encoding="UTF-8"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <preference for="Marsskom\Generator\Api\Data\CoordinatorInterface"
                type="Marsskom\Generator\Model\Console\Coordinator"/>

    <type name="Marsskom\Generator\Model\Console\BaseTranslator">
        <arguments>
            <argument name="inputTranslators" xsi:type="array">
                <item name="path"
                      xsi:type="object">Marsskom\Generator\Model\Console\Base\PathTranslator</item>
                <item name="module"
                      xsi:type="object">Marsskom\Generator\Model\Console\Base\ModuleTranslator</item>
                <item name="file"
                      xsi:type="object">Marsskom\Generator\Model\Console\Base\FileTranslator</item>
                <item name="class"
                      xsi:type="object">Marsskom\Generator\Model\Console\Base\ClassTranslator</item>
            </argument>
            <argument name="inputContexts" xsi:type="array">
                <item name="path"
                      xsi:type="object">Marsskom\Generator\Model\Context\Input\PathFactory</item>
                <item name="module"
                      xsi:type="object">Marsskom\Generator\Model\Context\Input\ModuleFactory</item>
                <item name="file"
                      xsi:type="object">Marsskom\Generator\Model\Context\Input\FileFactory</item>
                <item name="class"
                      xsi:type="object">Marsskom\Generator\Model\Context\Input\ClassInputFactory</item>
            </argument>
        </arguments>
    </type>

    <type name="Marsskom\Generator\Model\Console\Coordinator">
        <arguments>
            <argument name="translator"
                      xsi:type="object">Marsskom\Generator\Model\Console\BaseTranslator</argument>
        </arguments>
    </type>

    <virtualType name="FileSequence" type="Marsskom\Generator\Model\Php\Foundation\Sequence">
        <arguments>
            <argument name="sequences" xsi:type="array">
                <item name="file"
                      xsi:type="object"
                      sortOrder="5">Marsskom\Generator\Model\Php\Heap\FileGenerator</item>
                <item name="writer"
                      xsi:type="object"
                      sortOrder="100">Marsskom\Generator\Model\Php\Automation\Writer</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="ClassSequence" type="Marsskom\Generator\Model\Php\Foundation\Sequence">
        <arguments>
            <argument name="sequences" xsi:type="array">
                <item name="file"
                      xsi:type="object"
                      sortOrder="5">Marsskom\Generator\Model\Php\Heap\FileGenerator</item>
                <item name="class"
                      xsi:type="object"
                      sortOrder="10">Marsskom\Generator\Model\Php\Heap\ClassGenerator</item>
                <item name="writer"
                      xsi:type="object"
                      sortOrder="100">Marsskom\Generator\Model\Php\Automation\Writer</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Magento\Framework\Console\CommandList">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="generatorDataPatchCommand"
                      xsi:type="object">Marsskom\Generator\Console\Command\Patch\DataPatchCommand</item>
            </argument>
        </arguments>
    </type>

    <type name="Marsskom\Generator\Console\Command\Patch\DataPatchCommand">
        <arguments>
            <argument name="sequence" xsi:type="object">DataPatchSequence</argument>
            <argument name="inputTranslators" xsi:type="array">
                <item name="data_patch"
                      xsi:type="object">Marsskom\Generator\Model\Console\Command\DataPatchTranslator</item>
            </argument>
        </arguments>
    </type>
    <virtualType name="DataPatchSequence" type="ClassSequence">
        <arguments>
            <argument name="nextMiddlewares" xsi:type="array">
                <item name="file" xsi:type="array">
                    <item name="data_patch_file"
                          xsi:type="object"
                          sortOrder="5">Marsskom\Generator\Model\Php\Heap\Command\DataPatch\FileGenerator</item>
                </item>
                <item name="class" xsi:type="array">
                    <item name="data_patch_class"
                          xsi:type="object"
                          sortOrder="5">Marsskom\Generator\Model\Php\Heap\Command\DataPatch\ClassGenerator</item>
                </item>
            </argument>
        </arguments>
    </virtualType>
</config>
